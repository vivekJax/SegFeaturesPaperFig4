# ============================================================================
# Configuration File for Figure Generation Pipeline
# ============================================================================
# This file contains all configurable parameters for the pipeline.
# Modify values here to customize the figure generation process.
# All scripts read from this file automatically.
# ============================================================================

# ----------------------------------------------------------------------------
# File Paths
# ----------------------------------------------------------------------------
# All paths are relative to the project root directory
paths:
  # Input data file (relative to project root)
  # This CSV contains the raw performance metrics data with columns:
  # - train_label_size: Training dataset size (x-axis values)
  # - value: Performance metric value (y-axis values)
  # - color_var: Feature set name (determines line color)
  # - variable: Metric type (Precision, Recall, F1-score)
  # - plot_group: Panel category (Windows, Named Keypoints, Other Keypoints)
  input_data: "data/combined_df.csv"
  
  # Intermediate output from Step 1 (Python script)
  # This CSV contains the GAM fitted values extracted from plotnine
  # Generated by: scripts/export_plotnine_fits.py
  # Used by: scripts/plot_from_plotnine_csv.R
  gam_predictions: "data/plotnine_gam_predictions.csv"
  
  # Output files from Step 2 (R script)
  # These are the generated plot files (Panel A content)
  # Generated by: scripts/plot_from_plotnine_csv.R
  # Used by: scripts/combined_figure_final.tex
  plot_pdf: "fig_combined_from_plotnine.pdf"  # Vector format (used in LaTeX)
  plot_png: "fig_combined_from_plotnine.png"  # Raster format (300 DPI)
  plot_svg: "fig_combined_from_plotnine.svg"  # Vector format (optional)
  
  # Final output from Step 3 (LaTeX compilation)
  # This is the complete figure with both Panel A (plot) and Panel B (table)
  # Generated by: pdflatex combined_figure_final.tex
  final_figure: "combined_figure_final.pdf"
  
  # Icons directory
  # Contains PDF skeleton diagrams used in the summary table (Panel B)
  icons_dir: "icons"
  
  # Scripts directory
  # Contains all executable scripts (Python, R, LaTeX, Shell)
  scripts_dir: "scripts"
  
  # Log directory
  # Contains LaTeX build artifacts (.aux, .log, .fls, etc.)
  log_dir: "log"

# ----------------------------------------------------------------------------
# Step 1: Python GAM Export Settings
# ----------------------------------------------------------------------------
# Controls the Python script that extracts GAM fitted values from plotnine
step1_python:
  # Python script name (in scripts/ directory)
  script: "export_plotnine_fits.py"
  
  # Virtual environment path (relative to project root)
  # Python packages are installed here to avoid system conflicts
  venv_path: "venv"
  
  # GAM smoothing method
  # "auto" uses GAM (Generalized Additive Model) for large datasets
  # This matches plotnine's default behavior for geom_smooth(method='auto')
  smoothing_method: "auto"  # Uses GAM for large datasets
  
  # Whether to include confidence intervals (standard error bands)
  # Set to true to show uncertainty bands around fitted lines
  # Currently disabled (false) as we only extract the mean fitted values
  include_se: false

# ----------------------------------------------------------------------------
# Step 2: R Plot Generation Settings
# ----------------------------------------------------------------------------
# Controls the R script that generates the plot (Panel A content)
step2_r:
  # R script name (in scripts/ directory)
  script: "plot_from_plotnine_csv.R"
  
  # Figure dimensions
  # These control the size of the generated plot files (PDF, PNG, SVG)
  # Larger dimensions = more detail but larger file sizes
  figure_width: 6.0   # Width in inches (increased to fill Panel A better)
  figure_height: 7.0  # Height in inches (increased to fill Panel A better)
  figure_dpi: 300     # Resolution for PNG output (dots per inch)
                      # 300 DPI is standard for publication-quality figures
  
  # Font sizes (in points)
  # These control text readability and overall appearance
  font_base_size: 18      # Base font size for all text (pt) - increased for better readability
                           # This is the default size; other sizes are relative
  font_axis_text: 14      # Axis tick label size (pt) - increased from 12
                           # Numbers on x and y axes
  font_axis_title: 16     # Axis title size (pt) - increased from 14
                           # "Annotation Dataset Size" label
  font_strip_text: 14     # Facet label size (pt) - increased from 12
                           # Panel labels (Windows, Named Keypoints, etc.)
  
  # Plot styling
  line_width: 0.8         # Width of plot lines (relative units)
                          # Thicker lines = more visible but can look heavy
  show_legend: false      # Whether to show color legend
                          # Set to false because colors are shown in table (Panel B)
  
  # Plot group order (rows in faceted plot)
  # This controls the vertical order of the three main panels
  # Each string must match exactly the plot_group values in the data
  plot_group_order:
    - "Windows"           # First row (top panel)
    - "Named Keypoints"   # Second row (middle panel)
    - "Other Keypoints"   # Third row (bottom panel)
  
  # Color palette (hex codes matching plotnine)
  # These colors are applied to lines based on color_var values
  # Order must match the order of color_var categories in the data
  # Format: "#RRGGBB" where RR, GG, BB are hex values (00-FF)
  colors:
    # Colors for Windows feature sets (6 colors)
    # Applied to: All Keypoints + JABS/FFT/JAABA, Segmentation + JABS/FFT/JAABA
    windows:
      - "#1f77b4"  # Blue - All Keypoints JABS Window
      - "#ff7f0e"  # Orange - All Keypoints FFT Window
      - "#2ca02c"  # Green - All Keypoints JAABA Window
      - "#d62728"  # Red - Segmentation JABS Window
      - "#9467bd"  # Purple - Segmentation FFT Window
      - "#8c564b"  # Brown - Segmentation JAABA Window
    # Colors for Named Keypoints feature sets (4 colors)
    # Applied to: All Keypoints (JABS), MARS, MoSeq, Mouse Resource
    named_keypoints:
      - "#e377c2"  # Pink - All Keypoints (JABS)
      - "#7f7f7f"  # Gray - MARS
      - "#bcbd22"  # Yellow-green - MoSeq
      - "#17becf"  # Cyan - Mouse Resource
    # Colors for Other Keypoints feature sets (6 colors)
    # Applied to: No Ears, No Tail, No Paws, No Nose or Tail, Nose and Paws, Nose and Base Tail
    other_keypoints:
      - "#aec7e8"  # Light blue - No Ears
      - "#ff9896"  # Light red - No Tail
      - "#98df8a"  # Light green - No Paws
      - "#ffbb78"  # Light orange - No Nose or Tail
      - "#c49c94"  # Light brown - Nose and Paws
      - "#c5b0d5"  # Light purple - Nose and Base Tail

# ----------------------------------------------------------------------------
# Step 3: LaTeX Figure Combination Settings
# ----------------------------------------------------------------------------
# Controls the LaTeX document that combines plot (Panel A) and table (Panel B)
step3_latex:
  # LaTeX script name (in scripts/ directory)
  # This file is auto-generated from config.yaml by generate_latex_from_config.py
  script: "combined_figure_final.tex"
  
  # Panel A (Plot) settings
  # Controls the left side of the figure containing the performance plot
  panel_a:
    width_fraction: 0.65      # Fraction of page width (65% - increased to make A bigger)
                              # 0.0 to 1.0, where 1.0 = full page width
    height: 5.5                # Height in inches (increased to make A bigger)
                             # Controls vertical size of the panel
    keep_aspect_ratio: true  # Preserve aspect ratio of the plot
                              # true = plot maintains its proportions (recommended)
                              # false = plot can be stretched to fill panel
    label: "A"                # Panel label text (displayed above the plot)
    label_font: "sans-serif"  # Label font family
                              # "sans-serif" = clean, modern look (recommended)
                              # "serif" = traditional academic style
    label_size: "Large"       # Label size (LaTeX size command)
                              # Options: "tiny", "scriptsize", "footnotesize", "small",
                              #          "normalsize", "large", "Large", "LARGE", "huge", "Huge"
    label_spacing: "0.005cm" # Vertical spacing between label and figure
                              # Smaller values = label closer to plot vertically
                              # Larger values = more white space
    label_horizontal: "1.5cm"  # Horizontal offset of label (positive = move right)
                                # Negative values move label left, positive moves right
                                # 1.5cm moves label further to the right
  
  # Panel B (Table) settings
  # Controls the right side of the figure containing the summary table
  panel_b:
    width_fraction: 0.33      # Fraction of page width (33% - adjusted to match larger Panel A)
                              # Panel A + Panel B should sum to ~0.98 (leaving space for gap)
    height: 2.5               # Height in inches
                              # Controls vertical size of the table panel
    label: "B"                # Panel label text (displayed above the table)
    label_font: "sans-serif"  # Label font family (matches Panel A)
    label_size: "Large"       # Label size (matches Panel A)
    label_spacing: "0.02cm"   # Spacing between label and table (matches Panel A)
    font_size: "normalsize"   # Table font size (LaTeX size command) - increased from "small"
                              # Options: "tiny", "scriptsize", "footnotesize", "small", "normalsize", "large", etc.
                              # "normalsize" is larger than "small" for better readability
    row_stretch: 1.0          # Row height multiplier
                              # 1.0 = normal spacing
                              # >1.0 = more vertical space between rows
                              # <1.0 = tighter rows (may look cramped)
    col_sep: "4pt"            # Column separation (space between columns)
                              # Smaller values = tighter table
                              # Larger values = more readable but wider table
  
  # Table section order
  # Controls the vertical order of sections in the summary table
  # Must match the order used in plot_group_order for consistency
  table_sections:
    - "Windows"           # First section (top of table)
    - "Named Keypoints"   # Second section (middle of table)
    - "Other Keypoints"   # Third section (bottom of table)
  
  # Color square size for legend
  # The colored squares in the first column of the table that match plot colors
  color_square_size: "0.25cm"  # Size of color squares (width and height)
                                # Smaller = more compact table
                                # Larger = easier to see colors
  
  # Icon size in table
  # The skeleton diagram icons in the second column
  icon_size: "18px"            # Icon width (height scales proportionally)
                               # Smaller = more compact table
                               # Larger = easier to see details
  
  # Table styling colors
  # Background colors for table header and alternating rows
  # Format: hex color code without # symbol
  table_colors:
    header_bg: "F5F5F5"  # Header background color (light gray)
                         # Makes header row stand out
    row_light: "FAFAFA"  # Alternating row color (very light gray)
                         # Applied to every other row for readability
  
  # Page geometry
  # Controls the overall page size and margins
  # Set to match exact size of the figure (Panel A + Panel B + spacing)
  page:
    width: 8.5   # Page width in inches (restored to fit both panels properly)
                 # Panel A: 0.65 * 8.5 = 5.525in, Panel B: 0.33 * 8.5 = 2.805in
    height: 6.0  # Page height in inches (increased to fit labels and content)
                 # Panel A height is 5.5in, Panel B is 2.5in but aligned to top
                 # Extra height accounts for labels and spacing
    margin: 0.0  # Margin size in inches (zero margins for exact fit)

# ----------------------------------------------------------------------------
# Pipeline Execution Settings
# ----------------------------------------------------------------------------
# Controls how the pipeline script (run_pipeline.sh) behaves
pipeline:
  # Whether to stop on first error
  # true = pipeline stops if any step fails (recommended for debugging)
  # false = pipeline continues even if steps fail (may produce incomplete output)
  stop_on_error: true
  
  # Whether to clean up intermediate files after completion
  # true = removes intermediate files to save space
  # false = keeps all intermediate files (useful for debugging)
  cleanup_intermediate: false
  
  # Whether to move LaTeX build artifacts to log directory
  # true = organizes .aux, .log files into log/ (recommended)
  # false = leaves build artifacts in project root
  organize_logs: true
  
  # Output verbosity
  # true = shows detailed progress messages
  # false = minimal output
  verbose: true

# ----------------------------------------------------------------------------
# Table Data (F1 Scores and Feature Sets)
# ----------------------------------------------------------------------------
# Complete content for the summary table in Panel B
# Each entry defines a row in the table with its properties
table_data:
  # Windows section - Feature sets using window-based methods
  windows:
    - name: "All Keypoints + FFT"      # Feature set name (displayed in table)
      color: "#ff7f0e"                 # Hex color code (must match plot colors)
      icon: "JABS_Skeleton_colorized_red.pdf"  # Icon filename (in icons/ directory)
      f1: 0.917                        # F1 score (0.0 to 1.0)
      bold: true                       # Whether to bold this score (typically best in section)
    - name: "All Keypoints + JAABA"
      color: "#2ca02c"
      icon: "JABS_Skeleton_colorized_red.pdf"
      f1: 0.911
      bold: false
    - name: "All Keypoints + JABS"
      color: "#1f77b4"
      icon: "JABS_Skeleton_colorized_red.pdf"
      f1: 0.907
      bold: false
    - name: "Segmentation + FFT"
      color: "#9467bd"
      icon: "Segmentation_colorized_red.pdf"
      f1: 0.885
      bold: false
    - name: "Segmentation + JAABA"
      color: "#8c564b"
      icon: "Segmentation_colorized_red.pdf"
      f1: 0.862
      bold: false
    - name: "Segmentation + JABS"
      color: "#d62728"
      icon: "Segmentation_colorized_red.pdf"
      f1: 0.850
      bold: false
  
  # Named Keypoints section - Published keypoint sets
  named_keypoints:
    - name: "All Keypoints (JABS)"     # Feature set name
      color: "#e377c2"                 # Hex color (must match plot)
      icon: "JABS_Skeleton_colorized_red.pdf"  # Icon file
      f1: 0.917                        # F1 score
      bold: true                       # Bold if best in section
    - name: "MARS"
      color: "#7f7f7f"
      icon: "mars_no_front_paws_no_center_spine_Skeleton_colorized_red.pdf"
      f1: 0.900
      bold: false
    - name: "MoSeq"
      color: "#bcbd22"
      icon: "moseq_no_paws_no_tail_Skeleton_colorized_red.pdf"
      f1: 0.894
      bold: false
    - name: "Mouse Resource"
      color: "#17becf"
      icon: "sun_wang_paper_mars_no_tail_Skeleton_colorized_red.pdf"
      f1: 0.894
      bold: false
  
  # Other Keypoints section - Ablation study keypoint sets
  other_keypoints:
    - name: "No Ears"
      color: "#aec7e8"
      icon: "no_ears_Skeleton_colorized_red.pdf"
      f1: 0.904
      bold: false
    - name: "No Tail"
      color: "#ff9896"
      icon: "no_tail_Skeleton_colorized_red.pdf"
      f1: 0.906
      bold: true                       # Best score in this section
    - name: "No Paws"
      color: "#98df8a"
      icon: "no_paws_Skeleton_colorized_red.pdf"
      f1: 0.881
      bold: false
    - name: "No Nose or Tail"
      color: "#ffbb78"
      icon: "no_nose_no_tail_Skeleton_colorized_red.pdf"
      f1: 0.892
      bold: false
    - name: "Nose and Paws"
      color: "#c49c94"
      icon: "paws_and_nose_Skeleton_colorized_red.pdf"
      f1: 0.883
      bold: false
    - name: "Nose and Base Tail"
      color: "#c5b0d5"
      icon: "nose_butt_Skeleton_colorized_red.pdf"
      f1: 0.870
      bold: false
